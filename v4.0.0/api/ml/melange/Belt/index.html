<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Belt (melange.Belt)</title><link rel="stylesheet" href="../../odoc.support/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.3.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">melange</a> &#x00BB; Belt</nav><header class="odoc-preamble"><h1>Module <code><span>Belt</span></code></h1><p>A stdlib shipped with Melange</p><p>This stdlib is still in <i>beta</i> but we encourage you to try it out and give us feedback.</p><p><b>Motivation</b></p><p>The motivation for creating such library is to provide Melange users a better end-to-end user experience, since the original OCaml stdlib was not written with JS in mind. Below is a list of areas this lib aims to improve:</p><ol><li>Consistency in name convention: camlCase, and arguments order</li><li>Exception thrown functions are all suffixed with <i>Exn</i>, e.g, <i>getExn</i></li><li>Better performance and smaller code size running on JS platform</li></ol><p><b>Name Convention</b></p><p>For higher order functions, it will be suffixed <b>U</b> if it takes uncurried callback.</p><pre class="language-ocaml"><code>val forEach  : 'a t -&gt; ('a -&gt; unit) -&gt; unit
val forEachU : 'a t -&gt; ('a -&gt; unit [\@u]) -&gt; unit</code></pre><p>In general, uncurried version will be faster, but it may be less familiar to people who have a background in functional programming.</p><p><b>A special encoding for collection safety</b></p><p>When we create a collection library for a custom data type we need a way to provide a comparator function. Take <i>Set</i> for example, suppose its element type is a pair of ints, it needs a custom <i>compare</i> function that takes two tuples and returns their order. The <i>Set</i> could not just be typed as <code> Set.t (int * int) </code>, its customized <i>compare</i> function needs to manifest itself in the signature, otherwise, if the user creates another customized <i>compare</i> function, the two collection could mix which would result in runtime error.</p><p>The original OCaml stdlib solved the problem using <i>functor</i> which creates a big closure at runtime and makes dead code elimination much harder. We use a phantom type to solve the problem:</p><pre class="language-ocaml"><code>  module Comparable1 = Belt.Id.MakeComparable(struct
    type t = int * int
    let cmp (a0, a1) (b0, b1) =
      match Pervasives.compare a0 b0 with
      | 0 -&gt; Pervasives.compare a1 b1
      | c -&gt; c
  end)

let mySet1 = Belt.Set.make ~id:(module Comparable1)

module Comparable2 = Belt.Id.MakeComparable(struct
  type t = int * int
  let cmp (a0, a1) (b0, b1) =
    match Pervasives.compare a0 b0 with
    | 0 -&gt; Pervasives.compare a1 b1
    | c -&gt; c
end)

let mySet2 = Belt.Set.make ~id:(module Comparable2)</code></pre><p>Here, the compiler would infer <code>mySet1</code> and <code>mySet2</code> having different type, so e.g. a `merge` operation that tries to merge these two sets will correctly fail.</p><pre class="language-ocaml"><code>val mySet1 : ((int * int), Comparable1.identity) t
val mySet2 : ((int * int), Comparable2.identity) t</code></pre><p><code>Comparable1.identity</code> and <code>Comparable2.identity</code> are not the same using our encoding scheme.</p><p><b>Collection Hierarchy</b></p><p>In general, we provide a generic collection module, but also create specialized modules for commonly used data type. Take <i>Belt.Set</i> for example, we provide:</p><pre class="language-ocaml"><code>Belt.Set
Belt.Set.Int
Belt.Set.String</code></pre><p>The specialized modules <i>Belt.Set.Int</i>, <i>Belt.Set.String</i> are in general more efficient.</p><p>Currently, both <i>Belt_Set</i> and <i>Belt.Set</i> are accessible to users for some technical reasons, we <b>strongly recommend</b> users stick to qualified import, <i>Belt.Set</i>, we may hide the internal, <i>i.e</i>, <i>Belt_Set</i> in the future</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec module anchored" id="module-Id"><a href="#module-Id" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Id/index.html">Id</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p><a href="Id/index.html"><code>Belt.Id</code></a></p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Array"><a href="#module-Array" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Array/index.html">Array</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p><a href="Array/index.html"><code>Belt.Array</code></a></p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-SortArray"><a href="#module-SortArray" class="anchor"></a><code><span><span class="keyword">module</span> <a href="SortArray/index.html">SortArray</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p><a href="SortArray/index.html"><code>Belt.SortArray</code></a></p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-MutableQueue"><a href="#module-MutableQueue" class="anchor"></a><code><span><span class="keyword">module</span> <a href="MutableQueue/index.html">MutableQueue</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p><a href="MutableQueue/index.html"><code>Belt.MutableQueue</code></a></p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-MutableStack"><a href="#module-MutableStack" class="anchor"></a><code><span><span class="keyword">module</span> <a href="MutableStack/index.html">MutableStack</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p><a href="MutableStack/index.html"><code>Belt.MutableStack</code></a></p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-List"><a href="#module-List" class="anchor"></a><code><span><span class="keyword">module</span> <a href="List/index.html">List</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p><a href="List/index.html"><code>Belt.List</code></a></p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Range"><a href="#module-Range" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Range/index.html">Range</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p><a href="Range/index.html"><code>Belt.Range</code></a></p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Set"><a href="#module-Set" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Set/index.html">Set</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p><a href="Set/index.html"><code>Belt.Set</code></a></p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Map"><a href="#module-Map" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Map/index.html">Map</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p><a href="Map/index.html"><code>Belt.Map</code></a>,</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-MutableSet"><a href="#module-MutableSet" class="anchor"></a><code><span><span class="keyword">module</span> <a href="MutableSet/index.html">MutableSet</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p><a href="MutableSet/index.html"><code>Belt.MutableSet</code></a></p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-MutableMap"><a href="#module-MutableMap" class="anchor"></a><code><span><span class="keyword">module</span> <a href="MutableMap/index.html">MutableMap</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p><a href="MutableMap/index.html"><code>Belt.MutableMap</code></a></p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-HashSet"><a href="#module-HashSet" class="anchor"></a><code><span><span class="keyword">module</span> <a href="HashSet/index.html">HashSet</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p><a href="HashSet/index.html"><code>Belt.HashSet</code></a></p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-HashMap"><a href="#module-HashMap" class="anchor"></a><code><span><span class="keyword">module</span> <a href="HashMap/index.html">HashMap</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p><a href="HashMap/index.html"><code>Belt.HashMap</code></a></p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Option"><a href="#module-Option" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Option/index.html">Option</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p><a href="Option/index.html"><code>Belt.Option</code></a></p></div></div><p><a href="Result/index.html"><code>Belt.Result</code></a></p><p>Utilities for result data type.</p><div class="odoc-spec"><div class="spec module anchored" id="module-Result"><a href="#module-Result" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Result/index.html">Result</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p><a href="Result/index.html"><code>Belt.Result</code></a></p></div></div><p><a href="Int/index.html"><code>Belt.Int</code></a></p><p>Utilities for Int.</p><div class="odoc-spec"><div class="spec module anchored" id="module-Int"><a href="#module-Int" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Int/index.html">Int</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p><a href="Int/index.html"><code>Belt.Int</code></a> Utililites for Int</p></div></div><p><a href="Float/index.html"><code>Belt.Float</code></a></p><p>Utilities for Float.</p><div class="odoc-spec"><div class="spec module anchored" id="module-Float"><a href="#module-Float" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Float/index.html">Float</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p><a href="Float/index.html"><code>Belt.Float</code></a> Utililites for Float</p></div></div></div></body></html>
