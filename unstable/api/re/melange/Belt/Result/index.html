<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Result (melange.Belt.Result)</title><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.3.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script><link rel="canonical" href="https://melange.re/v2.2.0/api/re/melange/Belt/Result/index.html" /></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">melange</a> &#x00BB; <a href="../index.html">Belt</a> &#x00BB; Result</nav><header class="odoc-preamble"><h1>Module <code><span>Belt.Result</span></code></h1><p><a href="#"><code>Belt.Result</code></a></p><p>Utilities for result data type.</p></header><div class="odoc-content"><p><code>Belt.Result</code> is a data type with two variants: <code>Ok</code> and <code>Error</code>. Each of these variants can contain data, and those two pieces of data need not have the same data type. <code>Belt.Result</code> is useful when you need to not only determine whether some data is valid or not (use <code>Belt.Option</code> for that), but also keep information about the invalid data.</p><p>In the examples, we presume the existence of two variables:</p><pre class="language-ocaml"><code>let good = Ok 42
let bad = Error &quot;Invalid data&quot;</code></pre><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t('a, 'b)</span><span> = <a href="../../Stdlib/index.html#type-result">result</a><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span></span><span> = </span></code><ol><li id="type-t.Ok" class="def variant constructor anchored"><a href="#type-t.Ok" class="anchor"></a><code><span>| </span><span><span class="constructor">Ok</span>(<span class="type-var">'a</span>)</span></code></li><li id="type-t.Error" class="def variant constructor anchored"><a href="#type-t.Error" class="anchor"></a><code><span>| </span><span><span class="constructor">Error</span>(<span class="type-var">'b</span>)</span></code></li></ol><code><span>;</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-getExn"><a href="#val-getExn" class="anchor"></a><code><span><span class="keyword">let</span> getExn: <span><a href="#type-t">t</a><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <span class="arrow">=&gt;</span></span> <span class="type-var">'a</span>;</span></code></div><div class="spec-doc"><p><code>getExn res</code></p><p>when <code>res</code> is <code>Ok n</code>, returns <code>n</code> when <code>res</code> is <code>Error m</code>, <b>raise</b> an exception</p><pre class="language-ocaml"><code>getExn good = 42;;
getExn bad;; (* raises exception *)</code></pre></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mapWithDefaultU"><a href="#val-mapWithDefaultU" class="anchor"></a><code><span><span class="keyword">let</span> mapWithDefaultU: <span><a href="#type-t">t</a><span>(<span class="type-var">'a</span>, <span class="type-var">'c</span>)</span> <span class="arrow">=&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">=&gt;</span></span> <span><a href="../../Js/Fn/index.html#type-arity1">Js.Fn.arity1</a>(<span>(<span><span class="type-var">'a</span> <span class="arrow">=&gt;</span></span> <span class="type-var">'b</span>)</span>) <span class="arrow">=&gt;</span></span> <span class="type-var">'b</span>;</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mapWithDefault"><a href="#val-mapWithDefault" class="anchor"></a><code><span><span class="keyword">let</span> mapWithDefault: <span><a href="#type-t">t</a><span>(<span class="type-var">'a</span>, <span class="type-var">'c</span>)</span> <span class="arrow">=&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">=&gt;</span></span> <span><span>(<span><span class="type-var">'a</span> <span class="arrow">=&gt;</span></span> <span class="type-var">'b</span>)</span> <span class="arrow">=&gt;</span></span> <span class="type-var">'b</span>;</span></code></div><div class="spec-doc"><p><code>mapWithDefault res default f</code></p><p>When <code>res</code> is <code>Ok n</code>, returns <code>f n</code>, otherwise <code>default</code>.</p><pre class="language-ocaml"><code>mapWithDefault good 0 (fun x -&gt; x / 2) = 21
mapWithDefault bad 0 (fun x -&gt; x / 2) = 0</code></pre></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mapU"><a href="#val-mapU" class="anchor"></a><code><span><span class="keyword">let</span> mapU: <span><a href="#type-t">t</a><span>(<span class="type-var">'a</span>, <span class="type-var">'c</span>)</span> <span class="arrow">=&gt;</span></span> <span><a href="../../Js/Fn/index.html#type-arity1">Js.Fn.arity1</a>(<span>(<span><span class="type-var">'a</span> <span class="arrow">=&gt;</span></span> <span class="type-var">'b</span>)</span>) <span class="arrow">=&gt;</span></span> <a href="#type-t">t</a><span>(<span class="type-var">'b</span>, <span class="type-var">'c</span>)</span>;</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-map"><a href="#val-map" class="anchor"></a><code><span><span class="keyword">let</span> map: <span><a href="#type-t">t</a><span>(<span class="type-var">'a</span>, <span class="type-var">'c</span>)</span> <span class="arrow">=&gt;</span></span> <span><span>(<span><span class="type-var">'a</span> <span class="arrow">=&gt;</span></span> <span class="type-var">'b</span>)</span> <span class="arrow">=&gt;</span></span> <a href="#type-t">t</a><span>(<span class="type-var">'b</span>, <span class="type-var">'c</span>)</span>;</span></code></div><div class="spec-doc"><p><code>map res f</code></p><p>When <code>res</code> is <code>Ok n</code>, returns <code>Ok (f n)</code>. Otherwise returns <code>res</code> unchanged. Function <code>f</code> takes a value of the same type as <code>n</code> and returns an ordinary value.</p><pre class="language-ocaml"><code>let f x = sqrt (float_of_int x)
map (Ok 64) f = Ok 8.0
map (Error &quot;Invalid data&quot;) f = Error &quot;Invalid data&quot;</code></pre></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-flatMapU"><a href="#val-flatMapU" class="anchor"></a><code><span><span class="keyword">let</span> flatMapU: <span><a href="#type-t">t</a><span>(<span class="type-var">'a</span>, <span class="type-var">'c</span>)</span> <span class="arrow">=&gt;</span></span> <span><a href="../../Js/Fn/index.html#type-arity1">Js.Fn.arity1</a>(<span>(<span><span class="type-var">'a</span> <span class="arrow">=&gt;</span></span> <a href="#type-t">t</a><span>(<span class="type-var">'b</span>, <span class="type-var">'c</span>)</span>)</span>) <span class="arrow">=&gt;</span></span> <a href="#type-t">t</a><span>(<span class="type-var">'b</span>, <span class="type-var">'c</span>)</span>;</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-flatMap"><a href="#val-flatMap" class="anchor"></a><code><span><span class="keyword">let</span> flatMap: <span><a href="#type-t">t</a><span>(<span class="type-var">'a</span>, <span class="type-var">'c</span>)</span> <span class="arrow">=&gt;</span></span> <span><span>(<span><span class="type-var">'a</span> <span class="arrow">=&gt;</span></span> <a href="#type-t">t</a><span>(<span class="type-var">'b</span>, <span class="type-var">'c</span>)</span>)</span> <span class="arrow">=&gt;</span></span> <a href="#type-t">t</a><span>(<span class="type-var">'b</span>, <span class="type-var">'c</span>)</span>;</span></code></div><div class="spec-doc"><p><code>flatMap res f</code></p><p>When <code>res</code> is <code>Ok n</code>, returns <code>f n</code>. Otherwise, returns <code>res</code> unchanged. Function <code>f</code> takes a value of the same type as <code>n</code> and returns a <code>Belt.Result</code>.</p><pre class="language-ocaml"><code>let recip x =
  if x != 0.0
  then
    Ok (1.0 /. x)
  else
    Error &quot;Divide by zero&quot;

    flatMap (Ok 2.0) recip = Ok 0.5
    flatMap (Ok 0.0) recip = Error &quot;Divide by zero&quot;
    flatMap (Error &quot;Already bad&quot;) recip = Error &quot;Already bad&quot;</code></pre></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-getWithDefault"><a href="#val-getWithDefault" class="anchor"></a><code><span><span class="keyword">let</span> getWithDefault: <span><a href="#type-t">t</a><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <span class="arrow">=&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">=&gt;</span></span> <span class="type-var">'a</span>;</span></code></div><div class="spec-doc"><p><code>getWithDefault res defaultValue</code></p><p>if <code>res</code> is <code>Ok n</code>, returns <code>n</code>, otherwise <code>default</code></p><pre class="language-ocaml"><code>getWithDefault (Ok 42) 0 = 42
getWithDefault (Error &quot;Invalid Data&quot;) = 0</code></pre></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-isOk"><a href="#val-isOk" class="anchor"></a><code><span><span class="keyword">let</span> isOk: <span><a href="#type-t">t</a><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <span class="arrow">=&gt;</span></span> bool;</span></code></div><div class="spec-doc"><p><code>isOk res</code></p><p>Returns <code>true</code> if <code>res</code> is of the form <code>Ok n</code>, <code>false</code> if it is the <code>Error e</code> variant.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-isError"><a href="#val-isError" class="anchor"></a><code><span><span class="keyword">let</span> isError: <span><a href="#type-t">t</a><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>)</span> <span class="arrow">=&gt;</span></span> bool;</span></code></div><div class="spec-doc"><p><code>isError res</code></p><p>Returns <code>true</code> if <code>res</code> is of the form <code>Error e</code>, <code>false</code> if it is the <code>Ok n</code> variant.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-eqU"><a href="#val-eqU" class="anchor"></a><code><span><span class="keyword">let</span> eqU: <span><a href="#type-t">t</a><span>(<span class="type-var">'a</span>, <span class="type-var">'c</span>)</span> <span class="arrow">=&gt;</span></span> <span><a href="#type-t">t</a><span>(<span class="type-var">'b</span>, <span class="type-var">'d</span>)</span> <span class="arrow">=&gt;</span></span> <span><a href="../../Js/Fn/index.html#type-arity2">Js.Fn.arity2</a>(<span>(<span><span class="type-var">'a</span> <span class="arrow">=&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">=&gt;</span></span> bool)</span>) <span class="arrow">=&gt;</span></span> bool;</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-eq"><a href="#val-eq" class="anchor"></a><code><span><span class="keyword">let</span> eq: <span><a href="#type-t">t</a><span>(<span class="type-var">'a</span>, <span class="type-var">'c</span>)</span> <span class="arrow">=&gt;</span></span> <span><a href="#type-t">t</a><span>(<span class="type-var">'b</span>, <span class="type-var">'d</span>)</span> <span class="arrow">=&gt;</span></span> <span><span>(<span><span class="type-var">'a</span> <span class="arrow">=&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">=&gt;</span></span> bool)</span> <span class="arrow">=&gt;</span></span> bool;</span></code></div><div class="spec-doc"><p><code>eq res1 res2 f</code></p><p>Determine if two <code>Belt.Result</code> variables are equal with respect to an equality function. If <code>res1</code> and <code>res2</code> are of the form <code>Ok n</code> and <code>Ok m</code>, return the result of <code>f n m</code>. If one of <code>res1</code> and <code>res2</code> are of the form <code>Error e</code>, return false If both <code>res1</code> and <code>res2</code> are of the form <code>Error e</code>, return true</p><pre class="language-ocaml"><code>let good1 = Ok 42
let good2 = Ok 32
let bad1 = Error &quot;invalid&quot;
let bad2 = Error &quot;really invalid&quot;

let mod10equal a b =
  a mod 10 == b mod 10

eq good1 good2 mod10equal = true
eq good1 bad1 mod10equal = false
eq bad2 good2 mod10equal = false
eq bad1 bad2 mod10equal = true</code></pre></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-cmpU"><a href="#val-cmpU" class="anchor"></a><code><span><span class="keyword">let</span> cmpU: <span><a href="#type-t">t</a><span>(<span class="type-var">'a</span>, <span class="type-var">'c</span>)</span> <span class="arrow">=&gt;</span></span> <span><a href="#type-t">t</a><span>(<span class="type-var">'b</span>, <span class="type-var">'d</span>)</span> <span class="arrow">=&gt;</span></span> <span><a href="../../Js/Fn/index.html#type-arity2">Js.Fn.arity2</a>(<span>(<span><span class="type-var">'a</span> <span class="arrow">=&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">=&gt;</span></span> int)</span>) <span class="arrow">=&gt;</span></span> int;</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-cmp"><a href="#val-cmp" class="anchor"></a><code><span><span class="keyword">let</span> cmp: <span><a href="#type-t">t</a><span>(<span class="type-var">'a</span>, <span class="type-var">'c</span>)</span> <span class="arrow">=&gt;</span></span> <span><a href="#type-t">t</a><span>(<span class="type-var">'b</span>, <span class="type-var">'d</span>)</span> <span class="arrow">=&gt;</span></span> <span><span>(<span><span class="type-var">'a</span> <span class="arrow">=&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">=&gt;</span></span> int)</span> <span class="arrow">=&gt;</span></span> int;</span></code></div><div class="spec-doc"><p><code>cmp res1 res2 f</code></p><p>Compare two <code>Belt.Result</code> variables with respect to a comparison function. The comparison function returns -1 if the first variable is &quot;less than&quot; the second, 0 if the two variables are equal, and 1 if the first is &quot;greater than&quot; the second.</p><p>If <code>res1</code> and <code>res2</code> are of the form <code>Ok n</code> and <code>Ok m</code>, return the result of <code>f n m</code>. If <code>res1</code> is of the form <code>Error e</code> and <code>res2</code> of the form <code>Ok n</code>, return -1 (nothing is less than something) If <code>res1</code> is of the form <code>Ok n</code> and <code>res2</code> of the form <code>Error e</code>, return 1 (something is greater than nothing) If both <code>res1</code> and <code>res2</code> are of the form <code>Error e</code>, return 0 (equal)</p><pre class="language-ocaml"><code>let good1 = Ok 59
let good2 = Ok 37
let bad1 = Error &quot;invalid&quot;
let bad2 = Error &quot;really invalid&quot;

let mod10cmp a b =
  Pervasives.compare (a mod 10) (b mod 10)

cmp (Ok 39) (Ok 57) mod10cmp = 1
cmp (Ok 57) (Ok 39) mod10cmp = -1
cmp (Ok 39) (Error &quot;y&quot;) mod10cmp = 1
cmp (Error &quot;x&quot;) (Ok 57) mod10cmp = -1
cmp (Error &quot;x&quot;) (Error &quot;y&quot;) mod10cmp = 0</code></pre></div></div></div></body></html>
